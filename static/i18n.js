const i18n = {
    fr: {
        welcome: {
            title: "Que puis-je faire pour vous ?",
            subtitle: "Je suis votre assistant IA prêt à accomplir des tâches complexes"
        },
        config: {
            title: "Configuration système",
            subtitle: "Configurez les paramètres nécessaires pour utiliser le système",
            note: "Assurez-vous que les informations de configuration sont correctes.",
            apiKeyNote: "Si vous n'avez pas de clé API, obtenez-en une auprès de votre fournisseur.",
            llmConfig: "Configuration LLM",
            serverConfig: "Configuration serveur",
            save: "Sauvegarder",
            cancel: "Annuler",
            required: "*"
        },
        input: {
            placeholder: "Décrivez votre tâche...",
            button: "Créer"
        },
        history: {
            title: "Tâches"
        },
        status: {
            running: "Tâche en cours",
            completed: "Tâche terminée",
            failed: "Tâche échouée",
            error: "Erreur"
        },
        buttons: {
            configSetting: "Config"
        },
        sidebar: {
            newTask: "Nouvelle tâche",
            search: "Rechercher"
        }
    },
    en: {
        welcome: {
            title: "What can I do for you?",
            subtitle: "I'm your AI assistant ready to accomplish complex tasks"
        },
        config: {
            title: "System Configuration",
            subtitle: "Please fill in the necessary configuration information to continue using the system",
            note: "Please ensure that the following configuration information is correct.",
            apiKeyNote: "If you do not have an API key, please obtain one from the corresponding AI service provider.",
            llmConfig: "LLM Configuration",
            serverConfig: "Server Configuration",
            save: "Save Configuration",
            cancel: "Cancel",
            required: "*"
        },
        input: {
            placeholder: "Describe your task...",
            button: "Create"
        },
        history: {
            title: "Tasks"
        },
        status: {
            running: "Task running",
            completed: "Task completed",
            failed: "Task failed",
            error: "Error"
        },
        buttons: {
            configSetting: "Config"
        },
        sidebar: {
            newTask: "New task",
            search: "Search"
        }
    },
    zh: {
        welcome: {
            title: "我能为您做什么？",
            subtitle: "我是您的AI助手，随时准备完成复杂的任务"
        },
        config: {
            title: "系统配置",
            subtitle: "请填写必要的配置信息以继续使用系统",
            note: "请确保以下配置信息正确无误。",
            apiKeyNote: "如果您没有API密钥，请从相应的AI服务提供商获取。",
            llmConfig: "LLM 配置",
            serverConfig: "服务器配置",
            save: "保存配置",
            cancel: "取消",
            required: "*"
        },
        input: {
            placeholder: "描述您的任务...",
            button: "创建"
        },
        history: {
            title: "任务"
        },
        status: {
            running: "任务运行中",
            completed: "任务完成",
            failed: "任务失败",
            error: "错误"
        },
        buttons: {
            configSetting: "配置"
        },
        sidebar: {
            newTask: "新任务",
            search: "搜索"
        }
    },
    ja: {
        welcome: {
            title: "何かお手伝いできますか？",
            subtitle: "複雑なタスクを達成するAIアシスタントです"
        },
        config: {
            title: "システム設定",
            subtitle: "システムを使用するために必要な設定情報を入力してください",
            note: "以下の設定情報が正しいことを確認してください。",
            apiKeyNote: "APIキーをお持ちでない場合は、対応するAIサービスプロバイダーから取得してください。",
            llmConfig: "LLM 設定",
            serverConfig: "サーバー設定",
            save: "設定を保存",
            cancel: "キャンセル",
            required: "*"
        },
        input: {
            placeholder: "タスクを説明...",
            button: "作成"
        },
        history: {
            title: "タスク"
        },
        status: {
            running: "タスク実行中",
            completed: "タスク完了",
            failed: "タスク失敗",
            error: "エラー"
        },
        buttons: {
            configSetting: "設定"
        },
        sidebar: {
            newTask: "新規タスク",
            search: "検索"
        }
    },
    ko: {
        welcome: {
            title: "무엇을 도와드릴까요?",
            subtitle: "복잡한 작업을 수행하는 AI 어시스턴트입니다"
        },
        config: {
            title: "시스템 설정",
            subtitle: "시스템을 계속 사용하려면 필요한 구성 정보를 입력하세요",
            note: "다음 구성 정보가 올바른지 확인하세요.",
            apiKeyNote: "API 키가 없는 경우 해당 AI 서비스 제공업체에서 얻으세요.",
            llmConfig: "LLM 설정",
            serverConfig: "서버 설정",
            save: "설정 저장",
            cancel: "취소",
            required: "*"
        },
        input: {
            placeholder: "작업을 설명하세요...",
            button: "생성"
        },
        history: {
            title: "작업"
        },
        status: {
            running: "작업 실행 중",
            completed: "작업 완료",
            failed: "작업 실패",
            error: "오류"
        },
        buttons: {
            configSetting: "설정"
        },
        sidebar: {
            newTask: "새 작업",
            search: "검색"
        }
    },
    de: {
        welcome: {
            title: "Was kann ich für Sie tun?",
            subtitle: "Ich bin Ihr KI-Assistent für komplexe Aufgaben"
        },
        config: {
            title: "Systemkonfiguration",
            subtitle: "Bitte füllen Sie die erforderlichen Konfigurationsinformationen aus",
            note: "Bitte stellen Sie sicher, dass die folgenden Konfigurationsinformationen korrekt sind.",
            apiKeyNote: "Wenn Sie keinen API-Schlüssel haben, erhalten Sie diesen vom entsprechenden KI-Dienstanbieter.",
            llmConfig: "LLM Konfiguration",
            serverConfig: "Server Konfiguration",
            save: "Konfiguration speichern",
            cancel: "Abbrechen",
            required: "*"
        },
        input: {
            placeholder: "Beschreiben Sie Ihre Aufgabe...",
            button: "Erstellen"
        },
        history: {
            title: "Aufgaben"
        },
        status: {
            running: "Aufgabe wird ausgeführt",
            completed: "Aufgabe abgeschlossen",
            failed: "Aufgabe fehlgeschlagen",
            error: "Fehler"
        },
        buttons: {
            configSetting: "Einstellungen"
        },
        sidebar: {
            newTask: "Neue Aufgabe",
            search: "Suchen"
        }
    }
};


function getCurrentLanguage() {
    return localStorage.getItem('language') || 'en';
}

function setLanguage(lang) {
    localStorage.setItem('language', lang);
    updatePageContent(lang);
}

function updatePageContent(lang) {
    const texts = i18n[lang];
    if (!texts) return;

    // Welcome message
    const welcomeTitle = document.querySelector('.welcome-message h1');
    const welcomeSubtitle = document.querySelector('.welcome-message p');
    if (welcomeTitle) welcomeTitle.textContent = texts.welcome.title;
    if (welcomeSubtitle) welcomeSubtitle.textContent = texts.welcome.subtitle;

    // Config button
    const configBtn = document.getElementById('config-button');
    if (configBtn) {
        configBtn.value = texts.buttons.configSetting;
        configBtn.title = texts.buttons.configSetting;
    }

    // Config modal
    const configModalTitle = document.querySelector('.config-modal-header h2');
    const configModalSubtitle = document.querySelector('.config-modal-header p');
    if (configModalTitle) configModalTitle.textContent = texts.config.title;
    if (configModalSubtitle) configModalSubtitle.textContent = texts.config.subtitle;

    const noteBoxP1 = document.querySelector('.note-box p:first-child');
    const noteBoxP2 = document.querySelector('.note-box p:last-child');
    if (noteBoxP1) noteBoxP1.textContent = texts.config.note;
    if (noteBoxP2) noteBoxP2.textContent = texts.config.apiKeyNote;

    document.querySelectorAll('.config-section h3').forEach(h3 => {
        if (h3.textContent.includes('LLM') || h3.textContent.includes('Configuration LLM')) {
            h3.textContent = texts.config.llmConfig;
        } else if (h3.textContent.includes('Server') || h3.textContent.includes('serveur')) {
            h3.textContent = texts.config.serverConfig;
        }
    });

    const saveBtn = document.getElementById('save-config-btn');
    const cancelBtn = document.getElementById('cancel-config-btn');
    if (saveBtn) saveBtn.textContent = texts.config.save;
    if (cancelBtn) cancelBtn.textContent = texts.config.cancel;

    // Input field
    const promptInput = document.getElementById('prompt-input');
    if (promptInput) promptInput.placeholder = texts.input.placeholder;

    // History/Tasks title in sidebar
    const sidebarTitle = document.querySelector('.side-panel-header h2');
    if (sidebarTitle) sidebarTitle.textContent = texts.history.title;

    // Sidebar navigation buttons
    const sidebarBtns = document.querySelectorAll('.sidebar-btn');
    if (sidebarBtns.length >= 2 && texts.sidebar) {
        // First button is "New Task"
        const newTaskBtn = sidebarBtns[0];
        if (newTaskBtn) {
            const svg = newTaskBtn.querySelector('svg');
            newTaskBtn.innerHTML = '';
            if (svg) newTaskBtn.appendChild(svg);
            newTaskBtn.appendChild(document.createTextNode(' ' + texts.sidebar.newTask));
        }
        // Second button is "Search"
        const searchBtn = sidebarBtns[1];
        if (searchBtn) {
            const svg = searchBtn.querySelector('svg');
            searchBtn.innerHTML = '';
            if (svg) searchBtn.appendChild(svg);
            searchBtn.appendChild(document.createTextNode(' ' + texts.sidebar.search));
        }
    }

    // Required marks
    document.querySelectorAll('.required-mark').forEach(mark => {
        mark.textContent = texts.config.required;
    });
}

document.addEventListener('DOMContentLoaded', () => {
    const currentLang = getCurrentLanguage();
    const langSelect = document.getElementById('language-select');
    if (langSelect) {
        langSelect.value = currentLang;
        updatePageContent(currentLang);

        langSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });
    }
});

